<!DOCTYPE html>
<html lang="en">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117151898-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117151898-1'); 
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> TensorFlow Word Embedding tutorial - HackersFriend</title>
    
    <link rel="stylesheet" href="../../static/hfmain/css/main.css" />
    <script src="../../static/hfmain/js/offline.js"></script>
    <link rel="stylesheet" href="../../static/hfmain/css/offline_theme.css" />
    <link rel="stylesheet" href="../../static/hfmain/css/offline_english.css" />
    <script src="../../static/hfmain/js/main.js"></script>
     <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
     <link rel="shortcut icon" type="image/png" href="../../media/favicon.png"/>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color:	#375877">
        <a class="navbar-brand" href="../../index.html">HackersFriend</a>
        
        <button class="navbar-toggler" data-toggle="collapse" data-target="#collapse_target"><span class="navbar-toggler-icon"></span></button>
        <div class="collapse navbar-collapse" id="collapse_target">
          <ul class="navbar-nav ">
              <li class="nav-item">
                  <a class="nav-link" href="../../hackathons/index.html">Hackathons</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../workshops/index.html">Workshops</a>
                </li>
              <li class="nav-item">
                <a class="nav-link" href="../index.html">Tutorials</a>
              </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../../articles/index.html">Articles</a>
                      </li>
              
              <li class="nav-item">
                <a class="nav-link" href="../../projects/index.html">Projects</a>
              </li>
              
          </ul>
        <ul class="navbar-nav  ml-auto">
         
            <li class="nav-item">
              <a href="../../notifications/index.html" class="nav-link"><i class="material-icons"> notifications </i></a>
            </li>
            <li class="nav-item mr-2">
                <a href="../../login/index.html" class="nav-link btn btn-outline-secondary">Login</a>
              </li>

           <li class="nav-item">
             <a href="../../login/index.html" class="nav-link btn btn-outline-danger">Sign up</a>
           </li>
          </ul>
          
        </div>
    </nav>
    <br>
    <br>


<style>
  img{
    max-width:100%;
    height: auto;
  }
  .sidenav {
  height: 100%;
  width: 300px;
  position: fixed;
  z-index: 1;
  top: 0;
  left: 0;
  overflow-x: hidden;
  padding-top: 60px;
}
.sidenav-inner{
  height: 100%;
  width: 100%;
  overflow-y: scroll;
  overflow-x: hidden;
  padding-bottom: 10px;
}

.sidenav a {
  padding: 6px 8px 6px 16px;
  text-decoration: none;
  color: #818181;
  display: block;
}

.sidenav a:hover {
  color:black;
  background-color:whitesmoke;
}

.main {
  margin-left: 300px; /* Same as the width of the sidenav */
  background-color: white;
  padding: 0px 10px;
  padding-bottom: 200px;
 
}
footer{
  display: none;
}
.dropdown-topics{
  display: none;
}

@media screen and (max-height: 450px) {
  .sidenav {padding-top: 15px;}
  .sidenav a {font-size: 18px;}
}

@media screen and (max-width: 1024px) {
  .sidenav {
    display: none;
  }
 div.main{
   width: 100%;
   margin: 0;
 }
 div.dropdown-topics{
   display: block;
   margin-top: 60px;
   width: 100%;
   margin-bottom: 60px;
  
 }
 div.dropdown-menu{
   padding-top:80px;
  overflow: auto;
  background-color: #818181;
 }
}

  </style>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.3"></script>
<link rel="stylesheet" href="../../static/hfmain/css/prism.css" />
<script src="../../static/hfmain/js/prism.js"></script>
<div>
  
  <div class="sidenav">
      <div class="sidenav-inner">
        <br>
      <p class="text-center "><a href="../index.html" style="padding: 0; display:inline; ">Tutorials</a> &gt; <a style="padding: 0; display:inline;" href="index.html">TensorFlow</a></p>
                  <br>
           <div class="list-group">
                
                 
                <a href="introduction.html" class="list-group-item">Introduction &amp; Installation</a>
                
                
                 
                <a href="deep-learning-and-ai.html" class="list-group-item">Deep Learning &amp; Artificial Intelligence &amp; Machine Learning</a>
                
                
                 
                <a href="mathematics.html" class="list-group-item">Mathematics foundations</a>
                
                
                 
                <a href="basics.html" class="list-group-item">TensorFlow Basics</a>
                
                
                 
                <a href="convolutional-neural-network.html" class="list-group-item">Convolutional Neural Networks</a>
                
                
                 
                <a href="recurrent-neural-network.html" class="list-group-item">Recurrent Neural Networks</a>
                
                
                 
                <a href="TensorBoard-Visualization.html" class="list-group-item">TensorBoard Visualization</a>
                
                
                                 
                <a href="Word-Embedding.html" class="list-group-item active">Word Embedding</a>
                
                
                 
                <a href="Single-Layer-Perceptron.html" class="list-group-item">Single Layer Perceptron</a>
                
                
                 
                <a href="Linear-Regression.html" class="list-group-item">Linear Regression</a>
                
                
                 
                <a href="TFLearn.html" class="list-group-item">TFLearn</a>
                
                
                 
                <a href="cnn-rnn-difference.html" class="list-group-item">Difference between CNN and RNN</a>
                
                
                 
                <a href="keras.html" class="list-group-item">Keras</a>
                
                
                 
                <a href="distributed.html" class="list-group-item">Distributed Computing</a>
                
                
                 
                <a href="Exporting.html" class="list-group-item">Exporting</a>
                
                
                 
                <a href="Multi-Layer-Perceptron-Learning.html" class="list-group-item">Multi-Layer Perceptron Learning</a>
                
                
                 
                <a href="Hidden-Layers-Perceptron.html" class="list-group-item">Hidden Layers of Perceptron</a>
                
                
                 
                <a href="Optimizers.html" class="list-group-item">Optimizers</a>
                
                
                 
                <a href="XOR-Implementation.html" class="list-group-item">XOR Implementation</a>
                
                
                 
                <a href="Gradient-Descent-Optimization.html" class="list-group-item">Gradient Descent Optimization</a>
                
                
                 
                <a href="Forming-Graphs.html" class="list-group-item">Forming Graphs</a>
                
                
                 
                <a href="Image-Recognition.html" class="list-group-item">Image Recognition</a>
                
                
                 
                <a href="Neural-Network-Training.html" class="list-group-item">Neural Network Training</a>
                
                
              </div>
      </div>    

  </div>
  <div class="dropdown-topics">
      <div class="dropdown">
          <button type="button" style="width:100%"class="btn btn-secondary dropdown-toggle" data-toggle="dropdown">
           Topics
          </button>
          <div class="dropdown-menu" style="width: 100%">
                  
                   
                  <a href="introduction.html" class="dropdown-item">Introduction &amp; Installation</a>
                  
                  
                   
                  <a href="deep-learning-and-ai.html" class="dropdown-item">Deep Learning &amp; Artificial Intelligence &amp; Machine Learning</a>
                  
                  
                   
                  <a href="mathematics.html" class="dropdown-item">Mathematics foundations</a>
                  
                  
                   
                  <a href="basics.html" class="dropdown-item">TensorFlow Basics</a>
                  
                  
                   
                  <a href="convolutional-neural-network.html" class="dropdown-item">Convolutional Neural Networks</a>
                  
                  
                   
                  <a href="recurrent-neural-network.html" class="dropdown-item">Recurrent Neural Networks</a>
                  
                  
                   
                  <a href="TensorBoard-Visualization.html" class="dropdown-item">TensorBoard Visualization</a>
                  
                  
                   
                   <a class="dropdown-item active" href="Word-Embedding.html">Word Embedding</a>                
                  
                  
                   
                  <a href="Single-Layer-Perceptron.html" class="dropdown-item">Single Layer Perceptron</a>
                  
                  
                   
                  <a href="Linear-Regression.html" class="dropdown-item">Linear Regression</a>
                  
                  
                   
                  <a href="TFLearn.html" class="dropdown-item">TFLearn</a>
                  
                  
                   
                  <a href="cnn-rnn-difference.html" class="dropdown-item">Difference between CNN and RNN</a>
                  
                  
                   
                  <a href="keras.html" class="dropdown-item">Keras</a>
                  
                  
                   
                  <a href="distributed.html" class="dropdown-item">Distributed Computing</a>
                  
                  
                   
                  <a href="Exporting.html" class="dropdown-item">Exporting</a>
                  
                  
                   
                  <a href="Multi-Layer-Perceptron-Learning.html" class="dropdown-item">Multi-Layer Perceptron Learning</a>
                  
                  
                   
                  <a href="Hidden-Layers-Perceptron.html" class="dropdown-item">Hidden Layers of Perceptron</a>
                  
                  
                   
                  <a href="Optimizers.html" class="dropdown-item">Optimizers</a>
                  
                  
                   
                  <a href="XOR-Implementation.html" class="dropdown-item">XOR Implementation</a>
                  
                  
                   
                  <a href="Gradient-Descent-Optimization.html" class="dropdown-item">Gradient Descent Optimization</a>
                  
                  
                   
                  <a href="Forming-Graphs.html" class="dropdown-item">Forming Graphs</a>
                  
                  
                   
                  <a href="Image-Recognition.html" class="dropdown-item">Image Recognition</a>
                  
                  
                   
                  <a href="Neural-Network-Training.html" class="dropdown-item">Neural Network Training</a>
                  
                  
          </div>
        </div>

  </div>
  <div class="main">
      <br>
      <br>
      <p class="lead text-center">TensorFlow - Word Embedding</p>
      <br>
      <div class="container-fluid">
        <div class="row">
          <div class="col-sm-12">
            
            <a href="TensorBoard-Visualization.html" class="btn btn-info" style="float:left;"><i class="material-icons">keyboard_arrow_left</i> Previous </a>
            
            
            <a href="Single-Layer-Perceptron.html" class="btn btn-info" style="float: right;">Next <i class="material-icons">keyboard_arrow_right</i></a>
            
          </div>
          
        </div>
      </div>
      <br>
      <br>
      
        <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item">
                  <a href="#notes" class="nav-link active" data-toggle="tab" >Learn</a>
                </li>
               
                <li class="nav-item">
                    <a href="#problems" class="nav-link" data-toggle="tab">Practice</a>
                  </li>
              </ul>
            <!-- Tab panes -->
            <div class="tab-content">
            <div id="notes" class="container tab-pane active"><br>
              
              
              <p><strong>What is word Embedding ?</strong></p>

<p>Word embedding is&nbsp;concept of mapping from discrete objects to vectors and real numbers. For example&nbsp; - Mapping word into real numbers is word Embedding.</p>

<p>Well. Why do we do so ? Answer is, It is important for input for machine learning.</p>

<p>Word Embedding includes standard functions, which effectively transform discrete input objects to useful vectors.</p>

<p>Here is a sample example of word embedding input.</p>

<pre>
<code class="language-markdown">blue: (0.01359, 0.00075997, 0.24608, ..., -0.2524, 1.0048, 0.06259)
blues: (0.01396, 0.11887, -0.48963, ..., 0.033483, -0.10007, 0.1158)
orange: (-0.24776, -0.12359, 0.20986, ..., 0.079717, 0.23865, -0.014213)
oranges: (-0.35609, 0.21854, 0.080944, ..., -0.35413, 0.38511, -0.070976)</code></pre>

<p>&nbsp;</p>

<p><strong>Word2vec</strong></p>

<p>For unsupervised word embedding technique,&nbsp;Word2vec is the most common approach.&nbsp;It trains&nbsp;model in such a way that a given input word predicts the word&rsquo;s context by using <u>skip-grams</u>.</p>

<p>In TensorFlow we have many ways to implement this kind of model with increasing levels of sophistication and optimization and using multithreading concepts and higher-level abstractions.</p>

<p>&nbsp;</p>

<p><strong>Implemetation</strong></p>

<p>Have a look at the code. We have implemnted WordEmbedding.</p>

<pre>
<code class="language-python">import os 
import math 
import numpy as np 
import tensorflow as tf 

from tensorflow.contrib.tensorboard.plugins import projector 
batch_size = 64 
embedding_dimension = 5 
negative_samples = 8 
LOG_DIR = "logs/word2vec_intro" 

digit_to_word_map = {
   1: "One", 
   2: "Two", 
   3: "Three", 
   4: "Four", 
   5: "Five", 
   6: "Six", 
   7: "Seven", 
   8: "Eight", 
   9: "Nine"} 
sentences = [] 

# Create two kinds of sentences - sequences of odd and even digits. 
   for i in range(10000): 
   rand_odd_ints = np.random.choice(range(1, 10, 2), 3) 
      sentences.append(" ".join([digit_to_word_map[r] for r in rand_odd_ints])) 
   rand_even_ints = np.random.choice(range(2, 10, 2), 3) 
      sentences.append(" ".join([digit_to_word_map[r] for r in rand_even_ints])) 
   
# Map words to indices
word2index_map = {} 
index = 0 

for sent in sentences: 
   for word in sent.lower().split(): 
   
   if word not in word2index_map: 
      word2index_map[word] = index 
      index += 1 
index2word_map = {index: word for word, index in word2index_map.items()} 

vocabulary_size = len(index2word_map) 

# Generate skip-gram pairs 
skip_gram_pairs = [] 

for sent in sentences: 
   tokenized_sent = sent.lower().split() 
   
   for i in range(1, len(tokenized_sent)-1):        
      word_context_pair = [[word2index_map[tokenized_sent[i-1]], 
         word2index_map[tokenized_sent[i+1]]], word2index_map[tokenized_sent[i]]] 
      
      skip_gram_pairs.append([word_context_pair[1], word_context_pair[0][0]]) 
      skip_gram_pairs.append([word_context_pair[1], word_context_pair[0][1]]) 

def get_skipgram_batch(batch_size): 
   instance_indices = list(range(len(skip_gram_pairs))) 
      np.random.shuffle(instance_indices)
   batch = instance_indices[:batch_size] 
   x = [skip_gram_pairs[i][0] for i in batch] 
   y = [[skip_gram_pairs[i][1]] for i in batch] 
   return x, y 
   
# batch example 
x_batch, y_batch = get_skipgram_batch(8) 
x_batch 
y_batch 
[index2word_map[word] for word in x_batch] [index2word_map[word[0]] for word in y_batch] 

# Input data, labels train_inputs = tf.placeholder(tf.int32, shape = [batch_size]) 
   train_labels = tf.placeholder(tf.int32, shape = [batch_size, 1]) 

# Embedding lookup table currently only implemented in CPU with 
   tf.name_scope("embeddings"): 
   embeddings = tf.Variable(    
      tf.random_uniform([vocabulary_size, embedding_dimension], -1.0, 1.0), 
         name = 'embedding') 
   # This is essentialy a lookup table 
   embed = tf.nn.embedding_lookup(embeddings, train_inputs) 
   
# Create variables for the NCE loss
nce_weights = tf.Variable(     
   tf.truncated_normal([vocabulary_size, embedding_dimension], stddev = 1.0 / 
      math.sqrt(embedding_dimension))) 
   
nce_biases = tf.Variable(tf.zeros([vocabulary_size])) 

loss = tf.reduce_mean(     
   tf.nn.nce_loss(weights = nce_weights, biases = nce_biases, inputs = embed, 
   labels = train_labels,num_sampled = negative_samples, 
   num_classes = vocabulary_size)) tf.summary.scalar("NCE_loss", loss) 
   
# Learning rate decay 
global_step = tf.Variable(0, trainable = False) 
   learningRate = tf.train.exponential_decay(learning_rate = 0.1, 
   global_step = global_step, decay_steps = 1000, decay_rate = 0.95, staircase = True) 

train_step = tf.train.GradientDescentOptimizer(learningRate).minimize(loss) 
   merged = tf.summary.merge_all() 
with tf.Session() as sess: 
   train_writer = tf.summary.FileWriter(LOG_DIR,    
      graph = tf.get_default_graph()) 
   saver = tf.train.Saver() 
   
   with open(os.path.join(LOG_DIR, 'metadata.tsv'), "w") as metadata: 
      metadata.write('Name\tClass\n') for k, v in index2word_map.items(): 
      metadata.write('%s\t%d\n' % (v, k)) 
   
   config = projector.ProjectorConfig() 
   embedding = config.embeddings.add() embedding.tensor_name = embeddings.name 
   
   # Link this tensor to its metadata file (e.g. labels). 
   embedding.metadata_path = os.path.join(LOG_DIR, 'metadata.tsv') 
      projector.visualize_embeddings(train_writer, config) 
   
   tf.global_variables_initializer().run() 
   
   for step in range(1000): 
      x_batch, y_batch = get_skipgram_batch(batch_size) summary, _ = sess.run(
         [merged, train_step], feed_dict = {train_inputs: x_batch, train_labels: y_batch})
      train_writer.add_summary(summary, step)
      
      if step % 100 == 0:
         saver.save(sess, os.path.join(LOG_DIR, "w2v_model.ckpt"), step)
         loss_value = sess.run(loss, feed_dict = {
            train_inputs: x_batch, train_labels: y_batch})
         print("Loss at %d: %.5f" % (step, loss_value))

   # Normalize embeddings before using
   norm = tf.sqrt(tf.reduce_sum(tf.square(embeddings), 1, keep_dims = True))
   normalized_embeddings = embeddings /
      norm normalized_embeddings_matrix = sess.run(normalized_embeddings)
   
ref_word = normalized_embeddings_matrix[word2index_map["one"]]

cosine_dists = np.dot(normalized_embeddings_matrix, ref_word)
ff = np.argsort(cosine_dists)[::-1][1:10] for f in ff: print(index2word_map[f])
print(cosine_dists[f])</code></pre>

<p>&nbsp;</p>
              
              
              
            </div>
            <div id="problems" class="container-fluid tab-panes fade"><br>
              
                <p>No problems available for this topic.</p>
              
              
              
              
              <script>
                  function onans(option, ans)
                  {
                    var x = option.slice(0,option.lastIndexOf('_'));
                    var y = x+"_result";
                    if(option[option.length-1]==ans){
                      // we got to display correct icon and show explanation
                      document.getElementById(y).innerHTML = "Correct Answer!";
                      document.getElementById(y).style.color = "green";
                      document.getElementById(y).style.display = "block";
                      document.getElementById(option).style.color = "green";
                      // console.log("Correct ans");
                    }else{
                      // we got to blur that option
                      // console.log("Wrong ans");
                      document.getElementById(option).style.color="#e0dbdb";
                      document.getElementById(y).innerHTML = "Wrong Answer!";
                      document.getElementById(y).style.color = "red";
                      document.getElementById(y).style.display = "block";
                    }
                  }
  
                  function see_ans(x)
                  {
                    document.getElementById(x).style.display="block";
                  }
              </script>
           
          </div>
          <hr>
          <div class="container-fluid">
              <div class="row">
                <div class="col-sm-12">
                  
                  <a href="TensorBoard-Visualization.html" class="btn btn-info" style="float:left;"><i class="material-icons">keyboard_arrow_left</i> Previous </a>
                  
                  
                  <a href="Single-Layer-Perceptron.html" class="btn btn-info" style="float: right;">Next <i class="material-icons">keyboard_arrow_right</i></a>
                  
                </div>
                
              </div>
            </div>
          <br>
        <br>
          <center>
        <div class="fb-comments" data-href="https://www.hackersfriend.com/tutorials/TensorFlow/Word-Embedding.html" data-width="" data-numposts="10"></div>
      </center>
        </div>
  </div>

</div>
<script>
  pr = document.getElementsByTagName("pre");
  x = pr.length;
  if( x > 0)
  {
      for(i = 0; i<x; i++){
    pr[i].classList.add("line-numbers");
  }
  }
  </script>

<footer class="footer bg-dark mt-5 pt-3 pb-3 text-light" style="margin-bottom: -1px;">
<div class="container">
    
  <div class="row">
      <div class="col-md-4 col-sm-4">
         <h2>HackersFriend</h2>
          <hr style="width:75%; background: white;  margin: 0">
          <br>
          <table>
            <tbody>
              <tr>
                <td> <i class="material-icons">home</i> </td>
                <td class="pl-2">
                    HackersFriend office, Sector 37, Gurugram, India, 122004
                </td>
              </tr>
              <tr>
                  <td> <i class="material-icons">call</i> </td>
                  <td class="pl-2">
                      +91-9074202642
                  </td>
                </tr>
            
            </tbody>
          </table>
         
         <br>
         <a href="https://facebook.com/HackersFn" target="_blank"><img src="../../media/fb-icon.png" style="width:40px; height:40px;"></a>
         <a href="https://twitter.com/HackersFn" target="_blank"><img src="../../media/twitter-icon.png" style="width:40px; height:40px;"></a>
        <a  href="https://www.linkedin.com/company/hackersfriend/" target="_blank"><img src="../../media/linkedin-icon.png" style="width:35px; height:35px;"></a>
        <a  href="https://www.youtube.com/channel/UCbR73B5CesA1jjTPTWcLmKg/" target="_blank"><img src="../../media/youtube-icon.png" style="width:40px; height:40px;"></a>
       
      </div>
      <div class="col-md-2"></div>
    <div class="col-md-3 col-sm-3 mt-5">
        <h6 class="text-white">Quick Links</h6>
        <hr style="width:40%; background: white;  margin: 0">
        <br>
         <a href="../../verify-certificate.html">Verify certificate</a>
        <br>
        <a href="../../jobs/index.html">Work with us</a>
         
         <br> 
         <a href="../../intern/index.html" >Intern with us</a>
         <br>
         <a href="#">Become campus ambassdor</a>
         <br>
         <a href="../../innovative-startup.html">Submit your startup for innovative startups list</a>
         
         <br>
    </div>
    <div class="col-md-3 col-sm-3 mt-5">
        <h6 class="text-white">Business</h6>
        <hr style="width:35%; background: white;  margin: 0">
        <br>
        <a href="#">Hire talent</a>
        <br>
        <a href="#">Organize hackathons</a>
        <br>
        <a href="#">Outsource Project</a>
        <br>
        <a href="#">Consult Business</a>
        <br>
        <a href="#">Advertise with us</a>
    </div>
  </div>
  <br>
  <br>
  <center>
      <small style="color:grey;">&copy; HackersFriend | People also search us with HackerFriend, Hacker Friend and Hacker's Friend </small>
  </center>
  
</div>        
</footer>
</body>
</html>